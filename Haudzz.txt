local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- C·∫•u h√¨nh
local CorrectKey = "CHII_HAUU_2026" 
local HasKey = false
_G.AutoFarmChest = false

local Window = Rayfield:CreateWindow({
   Name = "üè¥‚Äç‚ò†Ô∏è Blox Fruits: Chii Hauu HUB",
   LoadingTitle = "H·ªá Th·ªëng D·ªãch Chuy·ªÉn T·ª©c Th·ªùi",
   LoadingSubtitle = "by Chii Hauu",
   ConfigurationSaving = { Enabled = false },
   KeySystem = false, 
   Keybind = "LeftControl", 
   Image = 1000021974 -- Avatar h√¨nh tr√≤n
})

-- H√†m ch√®n n·ªÅn ·∫£nh
local function AddBackground()
    pcall(function()
        local MainFrame = game:GetService("CoreGui").Rayfield.Main
        if not MainFrame:FindFirstChild("ChiiHauuBackground") then
            local BG = Instance.new("ImageLabel")
            BG.Name = "ChiiHauuBackground"
            BG.Parent = MainFrame
            BG.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            BG.BackgroundTransparency = 1.000
            BG.Size = UDim2.new(1, 0, 1, 0)
            BG.Image = "rbxassetid://1000021853" 
            BG.ImageTransparency = 0.5 
            BG.ZIndex = 0 
            local UICorner = Instance.new("UICorner")
            UICorner.CornerRadius = UDim.new(0, 10)
            UICorner.Parent = BG
        end
    end)
end
task.spawn(AddBackground)

-- 1. H√†m ƒê·ªïi Server
function ServerHop()
    local HttpService = game:GetService("HttpService")
    local TeleportService = game:GetService("TeleportService")
    pcall(function()
        local Servers = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"))
        for i, v in pairs(Servers.data) do
            if v.playing < v.maxPlayers and v.id ~= game.JobId then
                TeleportService:TeleportToPlaceInstance(game.PlaceId, v.id)
                break
            end
        end
    end)
end

-- 2. H√†m ki·ªÉm tra ƒë·ªì qu√Ω
function checkRareItems()
    local rareItems = {"God's Chalice", "Fist of Darkness"}
    for _, itemName in pairs(rareItems) do
        if game.Players.LocalPlayer.Backpack:FindFirstChild(itemName) or 
           (game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild(itemName)) then
            _G.AutoFarmChest = false 
            return true
        end
    end
    return false
end

-- 3. Noclip & Fix tr·ªçng l·ª±c (Ch·ªëng r∆°i khi TP)
task.spawn(function()
    game:GetService("RunService").Stepped:Connect(function()
        pcall(function()
            if _G.AutoFarmChest and game.Players.LocalPlayer.Character then
                local Root = game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                for _, v in pairs(game.Players.LocalPlayer.Character:GetDescendants()) do
                    if v:IsA("BasePart") then v.CanCollide = false end
                end
                if Root and not Root:FindFirstChild("ChiiHauuVel") then
                    local bv = Instance.new("BodyVelocity")
                    bv.Name = "ChiiHauuVel"
                    bv.Velocity = Vector3.new(0,0,0)
                    bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
                    bv.Parent = Root
                end
            else
                if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character.HumanoidRootPart:FindFirstChild("ChiiHauuVel") then
                    game.Players.LocalPlayer.Character.HumanoidRootPart.ChiiHauuVel:Destroy()
                end
            end
        end)
    end)
end)

-- LOGIC D·ªäCH CHUY·ªÇN T·ª®C TH·ªúI (INSTANT TP)
function doFarmChest()
    task.spawn(function()
        while _G.AutoFarmChest do
            task.wait() -- T·ªëc ƒë·ªô qu√©t r∆∞∆°ng c·ª±c nhanh
            
            if checkRareItems() then 
                Rayfield:Notify({Title = "‚ö†Ô∏è D·ª™NG L·∫†I!", Content = "ƒê√£ nh·∫∑t ƒë∆∞·ª£c ƒë·ªì qu√Ω!", Duration = 10})
                break 
            end

            local targetChest = nil
            local minDist = math.huge

            -- T√¨m r∆∞∆°ng g·∫ßn nh·∫•t
            for _, v in pairs(game:GetService("Workspace"):GetDescendants()) do
                if v:IsA("TouchTransmitter") and v.Parent and v.Parent.Name:find("Chest") then
                    local chest = v.Parent
                    local Root = game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                    if Root and chest:IsA("BasePart") then
                        local dist = (chest.Position - Root.Position).Magnitude
                        if dist < minDist then
                            minDist = dist
                            targetChest = chest
                        end
                    end
                end
            end

            if targetChest and _G.AutoFarmChest then
                local Root = game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                if Root then
                    -- D·ªäCH CHUY·ªÇN T·ª®C TH·ªúI ƒê·∫æN R∆Ø∆†NG
                    Root.CFrame = targetChest.CFrame
                    
                    -- ƒê·ª£i r∆∞∆°ng bi·∫øn m·∫•t r·ªìi m·ªõi t√¨m r∆∞∆°ng kh√°c (tr√°nh b·ªã k·∫πt 1 ch·ªó)
                    local timeout = 0
                    while targetChest.Parent and _G.AutoFarmChest do
                        task.wait()
                        timeout = timeout + 1
                        if timeout > 100 or checkRareItems() then break end
                    end
                end
            else
                -- Khi kh√¥ng c√≤n r∆∞∆°ng n√†o trong Server
                if _G.AutoFarmChest then
                    Rayfield:Notify({Title = "Chii Hauu", Content = "H·∫øt r∆∞∆°ng! ƒêang nh·∫£y Server...", Duration = 3})
                    task.wait(0.5)
                    ServerHop()
                    break
                end
            end
        end
    end)
end

-- TABS
local KeyTab = Window:CreateTab("üîë H·ªá Th·ªëng Key", 4483362458)
local MainTab = Window:CreateTab("üí∞ Auto Farm", 4483362458)

KeyTab:CreateInput({
   Name = "Nh·∫≠p Key",
   PlaceholderText = "Key: " .. CorrectKey,
   Callback = function(Text)
      if Text == CorrectKey then
         HasKey = true
         Rayfield:Notify({Title = "TH√ÄNH C√îNG", Content = "Ch√†o m·ª´ng Chii Hauu!", Duration = 5})
      end
   end,
})

MainTab:CreateToggle({
   Name = "B·∫≠t Auto Farm Chest (Instant TP)",
   CurrentValue = false,
   Callback = function(Value)
      if HasKey then
         _G.AutoFarmChest = Value
         if Value then doFarmChest() end
      else
         Rayfield:Notify({Title = "L·ªñI", Content = "Vui l√≤ng nh·∫≠p Key tr∆∞·ªõc!", Duration = 5})
      end
   end,
})

MainTab:CreateButton({
   Name = "üõë D·ª´ng To√†n B·ªô Script",
   Callback = function()
      _G.AutoFarmChest = false
      Rayfield:Destroy()
   end,
})
